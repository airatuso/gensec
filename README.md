# Инструмент для Генерации сертификатов

Это веб-приложение для генерации сертификатов на основе пользовательских шаблонов и данных участников. Приложение позволяет пользователям загружать собственный фон сертификата, настраивать текстовые поля и генерировать персонализированные сертификаты для участников, используя данные из Excel-файла. Сертификаты генерируются в векторном формате PDF для высокого качества. Ниже представлен краткий обзор ключевых возможностей и функционала приложения.

## Основные возможности

- **Загрузка собственного шаблона:** Пользователи могут загружать собственное изображение сертификата в формате (`PNG`, `JPG` или `JPEG`). Это изображение служит фоном для генерируемых сертификатов.
- **Загрузка файла данных:** Пользователи могут загрузить Excel файл (`XLS` или `XLSX`) с информацией об участниках. Каждая строка в файле представляет данные для отдельного сертификата.
- **Выбор и настройка полей:**
  - Пользователи могут выбрать, какие столбцы из Excel файла будут использоваться для создания сертификатов.
  - Каждое поле можно настроить, выбрав шрифт, цвет, размер и максимальную ширину текста.
  - **Поддерживаемые шрифты:** Система поддерживает несколько начертаний шрифта `Manrope` (`ExtraLight`, `Light`, `Regular`, `Medium`, `SemiBold`, `Bold`, `ExtraBold`). Также пользователи могут загружать свои собственные шрифты в формате `TTF` или `OTF`.
- **Интерактивное размещение текстовых полей:**
  - Пользователи могут перетаскивать текстовые поля по шаблону, чтобы точно позиционировать их.
  - **Визуализация ширины поля в реальном времени:** Приложение предоставляет живую визуализацию ширины текстового поля и поведения переноса текста, помогая пользователям видеть, как будут выглядеть сертификаты.
  - Добавлены **микро-анимации** при изменении размеров текстовых контейнеров для мгновенной визуальной обратной связи.
- **Генерация сертификатов:**
  - После настройки полей пользователи могут сгенерировать сертификаты для всех участников, указанных в Excel файле.
  - Система выводит каждый сертификат в формате векторного PDF, обеспечивая высокое качество текста и графики для печати.
  - Сгенерированные сертификаты упаковываются в ZIP-архив для удобного скачивания.

## Установка и Настройка

### Требования

- Python 3.8+
- Flask
- Pandas
- ReportLab
- PIL (Pillow)

### Шаги установки

1. Клонируйте репозиторий:
   ```sh
   git clone <repository-url>
   cd <repository-directory>
   ```
2. Создайте виртуальное окружение:
   ```sh
   python -m venv venv
   ```
3. Активируйте виртуальное окружение:

   - На Windows:
     ```sh
     venv\Scripts\activate
     ```
   - На macOS/Linux:
     ```sh
     source venv/bin/activate
     ```
4. Установите зависимости:
   ```sh
   pip install -r requirements.txt
   ```
5. Настройте переменные окружения:
   - Создайте файл `.env` в корневой директории.
   - Добавьте секретный ключ:
     ```sh
     SECRET_KEY=your_secret_key_here
     ```

6. Запустите приложение:
   ```sh
   flask run
   ```

### Структура файлов

- **`app.py`** - Основной скрипт приложения.
- **`templates/`** - HTML-шаблоны для различных шагов в процессе генерации сертификатов.
- **`static/uploads/`** - Директория для хранения загруженных пользователем изображений, шрифтов и данных.
- **`static/fonts/`** - Директория с системными шрифтами, такими как `Manrope`.
- **`app.log`** - Файл логов для отслеживания событий приложения и отладки.

## Использование

1. **Загрузка шаблона сертификата:**
   - Перейдите на главную страницу и загрузите ваше изображение шаблона сертификата.
2. **Загрузка данных участников:**
   - Загрузите Excel файл с информацией об участниках (например, ФИО, программа обучения и т.д.).
3. **Выбор и настройка полей:**
   - Выберите, какие столбцы из Excel файла вы хотите видеть на сертификате.
   - Настройте шрифт, размер и цвет для каждого выбранного поля.
4. **Размещение полей на шаблоне:**
   - Используйте интерфейс drag-and-drop для размещения полей на вашем шаблоне.
   - Изменяйте ширину текстовых контейнеров и наблюдайте изменения в реальном времени.
5. **Генерация сертификатов:**
   - Нажмите "Сгенерировать сертификаты" для создания PDF файлов для каждого участника.
   - Скачайте ZIP-архив, содержащий все сгенерированные сертификаты.

## Улучшения и Оптимизации

- **Регистрация шрифтов:** Переработана для более эффективной работы как с системными шрифтами (`Manrope`), так и с пользовательскими загружаемыми шрифтами.
- **Улучшенное логирование:** Улучшены сообщения в логах для лучшего отслеживания действий пользователя, особенно в процессе генерации PDF.
- **Оптимизация кода:** Удален неиспользуемый код (например, endpoint `progress`) и упрощены избыточные обновления сессии.
- **Улучшение пользовательского опыта:** Добавлены микро-анимации и динамические изменения ширины для создания более информативного интерфейса.

## Используемые технологии

- **Backend:** Flask, Python
- **Frontend:** HTML, CSS, JavaScript (с использованием jQuery для UI взаимодействий)
- **Генерация PDF:** ReportLab
- **Обработка изображений:** Pillow (PIL)

## Лицензия

Этот проект лицензирован по лицензии MIT.

## Участие

Пожалуйста, отправляйте сообщения об ошибках, предложения по улучшению или вносите свои предложения через pull requests. Любой вклад приветствуется!
